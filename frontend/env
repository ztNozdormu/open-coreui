# ========================================
# Open WebUI - Docker Compose Configuration
# ========================================
#
# This file is for Docker Compose deployments (docker-compose.yaml and docker-compose.dev.yaml)
#
# USAGE:
# 1. Copy this file to .env in the project root:
#    cp env.example .env
#
# 2. Edit the .env file and set your values (especially WEBUI_SECRET_KEY)
#
# 3. Start with Docker Compose:
#    docker compose up -d                           (production)
#    docker compose -f docker-compose.dev.yaml up -d (development)
#
# NOTE: For local Rust development (cargo run), use rust-backend/env.example instead.
#
# ========================================

# ----------------------------------------
# PostgreSQL Database Configuration
# ----------------------------------------
# Note: For docker-compose.dev.yaml (development), these match rust-backend/.env defaults
# For production, use stronger credentials
POSTGRES_DB=openwebui
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_PORT=5432

# ----------------------------------------
# Redis Configuration
# ----------------------------------------
REDIS_PORT=6379

# ----------------------------------------
# ChromaDB Configuration
# ----------------------------------------
CHROMA_PORT=8000
CHROMA_TELEMETRY=FALSE

# ----------------------------------------
# Server Configuration
# ----------------------------------------
HOST=0.0.0.0
RUST_PORT=8168
SOCKETIO_PORT=8081
OPEN_WEBUI_PORT=3000
ENV=prod

# ----------------------------------------
# Security & Authentication
# ----------------------------------------
# IMPORTANT: Set a fixed secret key to persist JWT tokens across restarts
# Generate a strong secret key (e.g., using: openssl rand -hex 32 or uuidgen)
# Example: WEBUI_SECRET_KEY=your-32-char-secret-key-here
WEBUI_SECRET_KEY=

# JWT Configuration
JWT_EXPIRES_IN=30d

# Authentication Options
ENABLE_SIGNUP=true
ENABLE_LOGIN_FORM=true
ENABLE_API_KEY=true
DEFAULT_USER_ROLE=user
SHOW_ADMIN_DETAILS=true

# ----------------------------------------
# Database Connection (Rust Backend)
# ----------------------------------------
# Auto-constructed from POSTGRES_* vars, but can be overridden
# For docker-compose: postgresql://${POSTGRES_USER}:${POSTGRES_PASSWORD}@postgres:5432/${POSTGRES_DB}
# For local dev: postgresql://postgres:postgres@localhost:5432/openwebui
# DATABASE_URL=postgresql://postgres:postgres@postgres:5432/openwebui

DATABASE_POOL_SIZE=20
DATABASE_POOL_MAX_OVERFLOW=10
DATABASE_POOL_TIMEOUT=30
DATABASE_POOL_RECYCLE=1800

# ----------------------------------------
# Redis Configuration (Rust Backend)
# ----------------------------------------
ENABLE_REDIS=true
# REDIS_URL=redis://redis:6379

# ----------------------------------------
# WebSocket/Socket.IO Configuration
# ----------------------------------------
ENABLE_WEBSOCKET_SUPPORT=true
WEBSOCKET_MANAGER=redis
# WEBSOCKET_REDIS_URL=redis://redis:6379

# ----------------------------------------
# CORS Configuration
# ----------------------------------------
CORS_ALLOW_ORIGIN=*
CORS_ORIGINS=*

# ----------------------------------------
# Application Features
# ----------------------------------------
ENABLE_OPENAI_API=true
ENABLE_CHANNELS=true
ENABLE_IMAGE_GENERATION=false
ENABLE_CODE_EXECUTION=false
ENABLE_WEB_SEARCH=false
ENABLE_ADMIN_CHAT_ACCESS=true
ENABLE_ADMIN_EXPORT=true
ENABLE_NOTES=true
ENABLE_COMMUNITY_SHARING=true
ENABLE_MESSAGE_RATING=true

# ----------------------------------------
# Storage Configuration
# ----------------------------------------
UPLOAD_DIR=/app/data/uploads
CACHE_DIR=/app/data/cache
STATIC_DIR=/app/static

# ----------------------------------------
# Logging Configuration
# ----------------------------------------
GLOBAL_LOG_LEVEL=info
RUST_LOG=info

# ----------------------------------------
# OpenAI Configuration
# ----------------------------------------
OPENAI_API_BASE_URL=
OPENAI_API_KEY=

# ----------------------------------------
# RAG & Embeddings (Python Backend)
# ----------------------------------------
RAG_EMBEDDING_MODEL=sentence-transformers/all-MiniLM-L6-v2
RAG_RERANKING_MODEL=
RAG_EMBEDDING_MODEL_AUTO_UPDATE=false

# RAG Search Options
ENABLE_RAG_WEB_SEARCH=false
ENABLE_RAG_HYBRID_SEARCH=false

# ----------------------------------------
# Whisper (Speech-to-Text)
# ----------------------------------------
WHISPER_MODEL=base

# ----------------------------------------
# Docker Build Arguments
# ----------------------------------------
BUILD_HASH=dev-build
USE_CUDA=false
USE_SLIM=false
USE_PERMISSION_HARDENING=false
USE_CUDA_VER=cu128
USE_EMBEDDING_MODEL=sentence-transformers/all-MiniLM-L6-v2
USE_RERANKING_MODEL=

# User/Group IDs (for non-root containers)
UID=0
GID=0

# ----------------------------------------
# Analytics & Tracking
# ----------------------------------------
SCARF_NO_ANALYTICS=true
DO_NOT_TRACK=true

# ----------------------------------------
# Application URLs (Internal)
# ----------------------------------------
WEBUI_URL=http://localhost:3000
BACKEND_URL=http://localhost:8168

